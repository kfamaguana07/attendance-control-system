BEGIN;
SET client_encoding TO 'UTF8';

CREATE SCHEMA IF NOT EXISTS personal;
SET search_path TO personal, public;
-- Base de datos: personal

--
-- Estructura de tabla para la tabla area
--

CREATE TABLE IF NOT EXISTS area (

  ID_A integer GENERATED BY DEFAULT AS IDENTITY,
  NOMBRE char(40) NOT NULL,
  DESCRIPCION char(40) NOT NULL,
  PRIMARY KEY (ID_A)
);

--
-- Volcado de datos para la tabla area
--

INSERT INTO area (ID_A, NOMBRE, DESCRIPCION) VALUES
(1, 'OPERACIONES', 'OPERADORES DE CALL CENTER'),
(2, 'SISTEMAS', 'PERSONAL DE TECNOLOGÍA'),
(3, 'ADMINISTRATIVA', 'ÁREA ADMINISTRATIVA'),
(4, 'OTROS', 'OTRAS ÁREAS');
-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla break
--

CREATE TABLE IF NOT EXISTS break (

  ID_B integer GENERATED BY DEFAULT AS IDENTITY,
  ID_T integer,
  HORA_INICIO_B time NOT NULL,
  TIEMPO_RECESO_B time NOT NULL,
  TOTAL_B time NOT NULL,
  NOMBRE_B char(40) NOT NULL,
  DESCRIPCION_B char(40) NOT NULL,
  TIPO_B char(40) NOT NULL,
  PRIMARY KEY (ID_B)
);

--
-- Volcado de datos para la tabla break
--

INSERT INTO break (ID_B, ID_T, HORA_INICIO_B, TIEMPO_RECESO_B, TOTAL_B, NOMBRE_B, DESCRIPCION_B, TIPO_B) VALUES
(1, 1, '10:30:00', '00:15:00', '00:15:00', 'BREAK 1', 'BREAK 1', 'BREAK'),
(2, 1, '11:00:00', '00:15:00', '00:15:00', 'BREAK 2', 'BREAK 2.1', 'BREAK'),
(3, 2, '09:30:00', '00:15:00', '00:15:00', 'BREAK 3', 'BREAK 3', 'BREAK'),
(4, 3, '12:30:00', '00:45:00', '00:45:00', 'ALMUERZO', 'ALMUERZO', 'ALMUERZO'),
(5, 3, '09:30:00', '00:15:00', '00:15:00', 'BREAK 3', 'BREAK 3', 'BREAK'),
(6, 4, '12:00:00', '00:45:00', '00:45:00', 'ALMUERZO', 'ALMUERZO', 'ALMUERZO'),
(7, 4, '10:00:00', '00:15:00', '00:15:00', 'BREAK', 'BREAK', 'BREAK'),
(8, 1, '14:00:00', '00:45:00', '00:45:00', 'ALMUERZO', 'ALMUERZO', 'ALMUERZO'),
(9, 5, '16:30:00', '00:15:00', '00:15:00', 'BREAK TARDE', 'BREAK TARDE', 'BREAK'),
(10, 5, '16:30:00', '00:15:00', '00:15:00', 'ALMUERZO TARDE', 'ALMUERZO TARDE', 'ALMUERZO'),
(11, 3, '12:00:00', '00:20:00', '00:20:00', 'BREAK', 'BREAK 20 MIN', 'BREAK'),
(12, 6, '15:00:00', '00:15:00', '00:15:00', 'BREAK TARDE', 'BREAK TARDE', 'BREAK'),
(13, 6, '12:30:00', '00:45:00', '00:45:00', 'ALMUERZO DINERS', 'ALMUERZO DINERS APOTO', 'ALMUERZO'),
(14, 4, '14:00:00', '01:00:00', '01:00:00', 'ALMUERZO', 'ALMUERZO', 'ALMUERZO'),
(15, 7, '08:00:00', '00:20:00', '00:20:00', 'NO BREAK', 'NO BREAK', 'BREAK'),
(16, 7, '13:30:00', '00:00:00', '00:00:00', 'NO ALMUERZO', 'NO ALMUERZO', 'ALMUERZO'),
(17, 8, '08:30:00', '00:00:00', '00:00:00', 'SIN ALMUERZO', 'SIN ALMUERZO', 'ALMUERZO'),
(18, 8, '07:00:00', '00:00:00', '00:00:00', 'SIN BREAK', 'SIN BREAK', 'BREAK');
-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla empleado
--

CREATE TABLE IF NOT EXISTS empleado (

  CI char(40) NOT NULL,
  ID_A integer ,
  ID_T integer ,
  ID_B integer ,
  ID_BA integer ,
  NOMBRES char(40) NOT NULL,
  APELLIDOS char(40) NOT NULL,
  DIRECCION char(254) NOT NULL,
  TELEFONOS char(254) NOT NULL,
  CORREO char(40) NOT NULL,
  FECHA_NACIMIENTO date NOT NULL,
  FECHA_INGRESO date NOT NULL,
  FECHA_CONTRATO date NOT NULL,
  SALARIO numeric(10,2) NOT NULL,
  clave varchar(254) ,
  PRIMARY KEY (CI)
);

--
-- Volcado de datos para la tabla empleado
--

INSERT INTO empleado (CI, ID_A, ID_T, ID_B, ID_BA, NOMBRES, APELLIDOS, DIRECCION, TELEFONOS, CORREO, FECHA_NACIMIENTO, FECHA_INGRESO, FECHA_CONTRATO, SALARIO, clave) VALUES
('0000000001', 1, 1, 1, 8, 'EMPLEADO', 'PRUEBA UNO', 'DIRECCION GENERICA 1', '0990000001', 'empleado1@test.com', '1990-01-01', '2017-01-01', '2017-01-01', '400.00', NULL),
('0000000002', 3, 8, 18, 17, 'EMPLEADO', 'PRUEBA DOS', 'DIRECCION GENERICA 2', '0990000002', 'empleado2@test.com', '1985-05-05', '2016-01-01', '2016-01-01', '500.00', 'd033e22ae348aeb5660fc2140aec35850c4da997'),
('0000000003', 2, 7, 15, 16, 'EMPLEADO', 'PRUEBA TRES', 'DIRECCION GENERICA 3', '0990000003', 'empleado3@test.com', '1992-10-10', '2017-02-01', '2017-02-01', '700.00', 'd033e22ae348aeb5660fc2140aec35850c4da997');
-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla firma
--

CREATE TABLE IF NOT EXISTS firma (

  ID_F integer GENERATED BY DEFAULT AS IDENTITY,
  FECHA_FIRMA date ,
  H_I_JORNADA time ,
  A_I_JORNADA time ,
  H_I_BREAK time ,
  H_F_BREAK time ,
  A_F_BREAK time ,
  H_I_ALMUERZO time ,
  H_F_ALMUERZO time ,
  A_F_ALMUERZO time ,
  H_F_JORNADA time ,
  CI varchar(40) NOT NULL,
  ID_T integer NOT NULL,
  ID_B integer NOT NULL,
  ID_BA integer NOT NULL,
  observacion varchar(254) ,
  PRIMARY KEY (ID_F)
);

--
-- Volcado de datos para la tabla firma
--
INSERT INTO firma (FECHA_FIRMA, H_I_JORNADA, A_I_JORNADA, H_I_BREAK, H_F_BREAK, A_F_BREAK, H_I_ALMUERZO, H_F_ALMUERZO, A_F_ALMUERZO, H_F_JORNADA, CI, ID_T, ID_B, ID_BA, observacion) VALUES
('2017-04-03', '08:00:00', '00:00:00', '10:30:00', '10:45:00', '00:00:00', '13:00:00', '14:00:00', '00:00:00', '17:00:00', '0000000001', 1, 1, 8, NULL),
('2017-04-03', '08:30:00', '00:00:00', '00:00:00', '00:00:00', '00:00:00', '00:00:00', '00:00:00', '00:00:00', '17:30:00', '0000000002', 8, 18, 17, 'SIN NOVEDAD'),
('2017-04-03', '09:00:00', '00:00:00', '11:00:00', '11:15:00', '00:00:00', '13:30:00', '14:30:00', '00:00:00', '18:00:00', '0000000003', 7, 15, 16, NULL);
-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla pausas
--

CREATE TABLE IF NOT EXISTS pausas (

  id_pausa integer GENERATED BY DEFAULT AS IDENTITY,
  tipo_pausa varchar(254) ,
  sub_tipo_pausa varchar(254) ,
  empleado_pausa varchar(254) ,
  observacion_pausa varchar(254) ,
  fecha_pausa date ,
  hora_inicio_pausa varchar(100) ,
  hora_fin_pausa varchar(100) ,
  fecha_edicion timestamp ,
  usuario_edicion varchar(100) ,
  PRIMARY KEY (id_pausa)
);

--
-- Volcado de datos para la tabla pausas
--
INSERT INTO pausas (tipo_pausa, sub_tipo_pausa, empleado_pausa, observacion_pausa, fecha_pausa, hora_inicio_pausa, hora_fin_pausa, fecha_edicion, usuario_edicion) VALUES
('TECNICA', 'SOPORTE', '0000000001', 'Fallo de internet en estación', '2017-04-10', '10:15:00', '10:30:00', '2017-04-10 10:35:00', 'ADMIN_SISTEMAS'),
('CAPACITACION', 'PRODUCTO', '0000000002', 'Actualización de campaña', '2017-04-11', '09:00:00', '10:00:00', '2017-04-11 10:05:00', 'SUPERVISOR_TEST'),
('PERSONAL', 'BAÑO', '0000000003', 'Pausa breve', '2017-04-12', '15:45:00', '15:52:00', '2017-04-12 15:55:00', 'AUTOGESTION');

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla turno
--

CREATE TABLE IF NOT EXISTS turno (

  ID_T integer GENERATED BY DEFAULT AS IDENTITY,
  HORA_INICIO_T time NOT NULL,
  HORA_FIN_T time NOT NULL,
  TOTAL_T time NOT NULL,
  NOMBRE_T char(40) NOT NULL,
  DESCRIPCION_T char(40) NOT NULL,
  TIPO_T char(40) NOT NULL,
  PRIMARY KEY (ID_T)
);

--
-- Volcado de datos para la tabla turno
--

INSERT INTO turno (ID_T, HORA_INICIO_T, HORA_FIN_T, TOTAL_T, NOMBRE_T, DESCRIPCION_T, TIPO_T) VALUES
(1, '08:30:00', '17:30:00', '09:00:00', 'TURNO COMPLETO', 'TURNO QUE ABRE LAS OFICINAS', 'NORMAL'),
(2, '09:00:00', '18:00:00', '09:00:00', 'SEGUNDO TURNO', '2DO TURNO', 'NORMAL'),
(3, '10:00:00', '17:00:00', '08:00:00', 'SEGUNDO TURNO', 'SEGU', 'NORMAL'),
(4, '09:00:00', '18:00:00', '09:00:00', 'TURNO DINERS', 'TURNO DINERS 2', 'NORMAL'),
(5, '14:30:00', '18:00:00', '03:30:00', 'TURNO DE LA TARDE', 'TURNO DE LA TARDE', 'NORMAL'),
(6, '09:00:00', '17:00:00', '08:00:00', 'TURNO DINERS', 'APOYO DINERS', 'NORMAL'),
(7, '08:30:00', '13:30:00', '05:00:00', 'MEDIO TURNO', 'TURNO DE 5 HORAS SIN BREAK NI ALMUERZO', 'NORMAL'),
(8, '09:00:00', '13:00:00', '04:00:00', 'MEDIO TIEMPO', 'NUEVO HORARIO ADMINISTRATIVO', 'NORMAL');


--
-- Restricciones para tablas volcadas
--

--
-- Filtros para la tabla break
--
ALTER TABLE break ADD CONSTRAINT fk_relationship_1 FOREIGN KEY (id_t) REFERENCES turno (id_t);

--
-- Filtros para la tabla empleado
--
ALTER TABLE empleado
  ADD CONSTRAINT FK_RELATIONSHIP_2 FOREIGN KEY (ID_A) REFERENCES area (ID_A),
  ADD CONSTRAINT FK_RELATIONSHIP_3 FOREIGN KEY (ID_T) REFERENCES turno (ID_T);

CREATE INDEX IF NOT EXISTS fk_relationship_1 ON break (id_t);
CREATE INDEX IF NOT EXISTS fk_relationship_2 ON empleado (id_a);
CREATE INDEX IF NOT EXISTS fk_relationship_3 ON empleado (id_t);
CREATE INDEX IF NOT EXISTS id_b ON empleado (id_b);
CREATE INDEX IF NOT EXISTS id_ba ON empleado (id_ba);

COMMIT;
